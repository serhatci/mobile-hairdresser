language: node_js

services:
  - docker

script:
  - docker-compose --version
  - docker-compose -f docker-compose.e2e-test.yml up -d
  - docker-compose ps
  - docker-compose exec backend echo $COVERALLS_REPO_TOKEN
  - docker-compose exec backend npm run test-coverage
  - docker cp "$(docker-compose ps -q backend)":/app/coverage ./coverage
  - npm i coveralls
  - npm i -g npx
  - npx coveralls < coverage/lcov.info

notification:
  - emails: false
